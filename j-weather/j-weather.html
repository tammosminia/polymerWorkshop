<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-input/iron-input.html">
<link rel="import" href="../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="location-validator.html">
<link rel="import" href="weather-for-city.html">

<!--
`j-weather`
polymer workshop

@demo demo/index.html 
-->

<dom-module id="j-weather">
    <template>
        <style>
            :host {
                display: block;
            }
        </style>
        <h2>Hello [[prop1]]</h2>

        <form>
            <location-validator id="validator1" validator-name="validator1"></location-validator>
            <input auto-validate is="iron-input" required bind-value="{{newLocation}}">
            <button on-tap="addLocation">add</button>
        </form>

        <h3>Interesting locations</h3>
        <ul>
            <template is="dom-repeat" items="[[locations]]" index-as="index">
                <li>
                    <weather-for-city city="[[item]]"></weather-for-city>
                    <button on-tap="removeLocation" data-args="[[index]]">remove</button>
                </li>
            </template>
        </ul>
    </template>

    <script>
        Polymer({

            is: 'j-weather',

            behaviors: [
                Polymer.IronValidatableBehavior
            ],

            properties: {
                prop1: {
                    type: String,
                    value: 'j-weather',
                },

                newLocation: String,

                locations: {
                    type: Array,
                    value: function () {
                        return ["Amsterdam"]
                    }
                }
            },

            addLocation: function () {
                console.log("adding " + this.newLocation);
                this.push("locations", this.newLocation); //use the Polymer push function, otherwise databinding won't be noticed
                this.newLocation = "";
                console.log(this.locations);
            },

            removeLocation: function(event) {
                var index = event.target.dataArgs;
                console.log("removind index " + index);
                this.splice('locations', index, 1);
            }


        });
    </script>
</dom-module>
